# Docking to Logging Center -- TraceId Integration with Logging Components

With the toolkit provided by Skywalking, we can integrate the TraceId uniquely generated by Skywalking during the tracing process to the common logging components logback and log4j in our business applications. lo4j supports versions 1.x and 2.x.

The reference source code for this section is available at [Github](https://github.com/DaoCloud-Labs/DMP-Demo/blob/master/skywalking/dmp-skywalking-agent-examples-master/dmp-skywalking-agent-integration-log4j-demo/README.md)

Final result.

```shell
2018-07-25 17:44:58.842 [TID:N/A] [main] INFO  o.s.b.c.e.t.TomcatEmbeddedServletContainer -Tomcat started on port(s): 8001 (http)
2018-07-25 17:44:58.852 [TID:N/A] [main] INFO  i.d.n.s.l.AgentLog4jDemoApplication -Started AgentLog4jDemoApplication in 4.03 seconds (JVM running for 12.204)
2018-07-25 17:45:10.226 [TID:39.58.15325119102050001] [http-nio-8001-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -Initializing Spring FrameworkServlet 'dispatcherServlet'
2018-07-25 17:45:10.226 [TID:39.58.15325119102050001] [http-nio-8001-exec-1] INFO  o.s.web.servlet.DispatcherServlet -FrameworkServlet 'dispatcherServlet': initialization started
2018-07-25 17:45:10.247 [TID:39.58.15325119102050001] [http-nio-8001-exec-1] INFO  o.s.web.servlet.DispatcherServlet -FrameworkServlet 'dispatcherServlet': initialization completed in 21 ms
2018-07-25 17:45:10.314 [TID:39.58.15325119102050001] [http-nio-8001-exec-1] INFO  i.d.n.sw.log4j.HelloWorldController -words:demo
```

## Step 1
Using the **logback** toolkit as an example, import the appropriate dependency toolkit in your business project using either Maven or Gradle at

- Maven
Add the following dependencies to the pom.xml file.

```xml
<!-- https://mvnrepository.com/artifact/org.apache.skywalking/apm-toolkit-logback-1.x -->
<dependency>
    <groupId>org.apache.skywalking</groupId>
    <artifactId>apm-toolkit-logback-1.x</artifactId>
    <version>6.6.0</version>
</dependency>
```

Note: Toolkit versions can be found in：https://mvnrepository.com/artifact/org.apache.skywalking/apm-toolkit-logback-1.x

- Gradle
Configure the following dependencies in build.gradle：

```xml
dependencies {
	······
    compile 'org.apache.skywalking:apm-toolkit-logback-1.x:6.6.0'
	······
}
```

## Step 2
The following configuration needs to be added to your logging component configuration file.

```xml
......
<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
      <encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
          <layout class="org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout">
              <Pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%tid] [%thread] %-5level %logger{36} -%msg%n</Pattern>
          </layout>
      </encoder>
</appender>
......
```

## Finally run your application/service
Use **-javaagent** parameter to activate Skywalking's probe, logback will output traceId if traceid exists in the current context. otherwise it will output TID: N/A.

### -Use of javaagent

```shell
java -javaagent:/Your/path/to/skywalking/agent/incubator-skywalking/skywalking-agent/skywalking-agent.jar -jar -Dskywalking.agent.service_name=demo-project demo-project.jar
```

You can also refer to the **Jar/War package access to Skywalking** in the previous section.